--- virgl-upstream/src/vrend/vrend_formats.c	2026-01-25 22:49:13	2026-01-25 22:00:00
+++ virgl-patched/src/vrend/vrend_formats.c	2026-01-25 22:51:25	2026-01-25 22:00:00
@@ -624,6 +624,21 @@
 
 }
 
+/* Core Profile format overrides - GL_BGRA not valid in Core Profile */
+static struct vrend_format_table core_profile_bgra_overrides[] = {
+  /* A8R8G8B8 and X8R8G8B8: Use GL_RGBA with swizzle instead of GL_BGRA */
+  { VIRGL_FORMAT_A8R8G8B8_UNORM, GL_RGBA8, GL_RGBA, GL_UNSIGNED_BYTE, BGRA_SWIZZLE, view_class_32 },
+  { VIRGL_FORMAT_X8R8G8B8_UNORM, GL_RGBA8, GL_RGBA, GL_UNSIGNED_BYTE, BGR1_SWIZZLE, view_class_32 },
+  /* Other BGRA formats: Use GL_RGBA with swizzle */
+  { VIRGL_FORMAT_B4G4R4X4_UNORM, GL_RGBA4, GL_RGBA, GL_UNSIGNED_SHORT_4_4_4_4_REV, RGB1_SWIZZLE, view_class_unsupported },
+  { VIRGL_FORMAT_B5G5R5X1_UNORM, GL_RGB5_A1, GL_RGBA, GL_UNSIGNED_SHORT_1_5_5_5_REV, RGB1_SWIZZLE, view_class_unsupported },
+};
+
+void vrend_build_format_list_core_profile_override(void)
+{
+  add_formats(core_profile_bgra_overrides);
+}
+
 /* glTexStorage may not support all that is supported by glTexImage,
  * so add a flag to indicate when it can be used.
  */
