--- a/src/vrend/vrend_renderer.c
+++ b/src/vrend/vrend_renderer.c
@@ -1389,9 +1389,23 @@
 {
    GLint param;
    const char *shader_parts[SHADER_MAX_STRINGS];
+   char *replaced_parts[SHADER_MAX_STRINGS] = {0};
 
    for (int i = 0; i < shader->glsl_strings.num_strings; i++)
-      shader_parts[i] = shader->glsl_strings.strings[i].buf;
+      replaced_parts[i] = strdup(shader->glsl_strings.strings[i].buf);
+
+   /* GL_EXT_shader_texture_lod is not available in macOS Core Profile (frozen at GL 4.1).
+    * However, GL_ARB_shader_texture_lod is available and provides the same functionality.
+    * Replace the EXT extension name with ARB to allow shaders to compile. */
+   for (int i = 0; i < shader->glsl_strings.num_strings; i++) {
+      if (strstr(replaced_parts[i], "GL_EXT_shader_texture_lod")) {
+         char *found;
+         while ((found = strstr(replaced_parts[i], "GL_EXT_shader_texture_lod"))) {
+            memcpy(found, "GL_ARB_shader_texture_lod", 22);
+         }
+      }
+      shader_parts[i] = replaced_parts[i];
+   }
 
    shader->id = glCreateShader(conv_shader_type(shader->sel->type));
    glShaderSource(shader->id, shader->glsl_strings.num_strings, shader_parts, NULL);
@@ -1404,7 +1418,7 @@
       vrend_report_context_error(sub_ctx->parent, VIRGL_ERROR_CTX_ILLEGAL_SHADER, 0);
       virgl_error("Shader failed to compile\n%s\n", infolog);
       vrend_shader_dump(shader);
-      return false;
+      goto cleanup;
    }
 
    if (shader->sel->sinfo.separable_program) {
@@ -1415,6 +1429,10 @@
    }
 
    shader->is_compiled = true;
+cleanup:
+   for (int i = 0; i < shader->glsl_strings.num_strings; i++) {
+      free(replaced_parts[i]);
+   }
    return true;
 }
 
